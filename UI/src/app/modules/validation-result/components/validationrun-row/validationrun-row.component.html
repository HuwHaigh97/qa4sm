<p-panel *ngIf="published">
  <ng-template pTemplate="header">
    <h5 class="my-0"><span class=" font-weight-normal">Name:</span> {{ model.validationRun.name_tag }}</h5>
  </ng-template>
  <ng-template pTemplate="icons" class="doilink">
    <h5 class="my-0"> DOI: <a class="doilink" target="_blank"
                              href="{{this.getDoiPrefix()}}{{ model.validationRun.doi }}">{{ model.validationRun.doi }}</a>
    </h5>
  </ng-template>
  <div class="p-grid">
    <div class="p-col-4">
      <strong>Data:</strong><br/>
      <span *ngFor="let datasetRowModel of model.datasetRows">
          {{(datasetRowModel.dataset$|async)?.pretty_name}},
        {{(datasetRowModel.datasetVersion$|async)?.pretty_name}},
        {{(datasetRowModel.datasetVariable$|async)?.pretty_name}} <br>
        </span>

    </div>

    <div class="p-col-4">
      <strong>Reference:</strong><br/>
      <span>
          {{(model.referenceRow.dataset$|async)?.pretty_name}},
        {{(model.referenceRow.datasetVersion$|async)?.pretty_name}},
        {{(model.referenceRow.datasetVariable$|async)?.pretty_name}}
        </span>
    </div>

    <div class="p-col-2" style="max-width: 7rem;">
      <strong>Created:</strong><br/>
      {{ model.validationRun.start_time|date:"YYYY-MM-dd" }}
    </div>
  </div>
</p-panel>

<!-- Custom validations-->
<p-panel *ngIf="!published">
  <ng-template pTemplate="header">
    <h5 class="my-0" style="float: left">
      <!--      if there is expiry date property: -->
      <span *ngIf="validationRun.expiry_date">
        <label *ngIf="validationRun.is_near_expiry" class="p-panel-header-icon"
               pTooltip="This validation will SOON be automatically removed during cleanup on
                        {{ validationRun.expiry_date|date: dateFormat :timeZone}}."
               tooltipPosition="bottom">
          <span class="pi pi-exclamation-triangle expiry-icons"></span>
        </label>
        <label *ngIf="!validationRun.is_near_expiry" class="p-panel-header-icon"
               pTooltip="This validation will be automatically removed during cleanup on {{ validationRun.expiry_date|date: dateFormat :timeZone }}."
               tooltipPosition="bottom">
          <span class="pi pi-calendar expiry-icons" title=""></span>
        </label>
      </span>
      <!--      if there is no expiry date property: -->
      <span *ngIf="!validationRun.expiry_date">
        <label *ngIf="validationRun.progress === -1" class="p-panel-header-icon"
               pTooltip="This validation was cancelled."
               tooltipPosition="bottom">
          <span class="pi pi-ban expiry-icons" title=""></span>
        </label>
        <label *ngIf="!validationRun.end_time && validationRun.progress === 0" class="p-panel-header-icon"
               pTooltip="This validation is still running."
               tooltipPosition="bottom">
          <span class="pi pi-spin pi-spinner expiry-icons" title=""></span>
        </label>

        <label *ngIf="validationRun.doi" class="p-panel-header-icon"
               pTooltip="This result has been published with zenodo. It will NOT be automatically removed during cleanup."
               tooltipPosition="bottom">
          <a class="doilink" target="_blank" href="{{getDoiPrefix()}}{{ validationRun.doi }}"><span
            class="pi pi-book expiry-icons"></span></a>

        </label>

        <label *ngIf="validationRun.is_archived" class="p-panel-header-icon"
               pTooltip="This validation has been archived. It will NOT be automatically removed during cleanup."
               tooltipPosition="bottom">
         <fa-icon class="expiry-icons" [icon]="faIcons.faArchive"></fa-icon>
        </label>

      </span>

      <span class=" font-weight-normal">Started:
        {{ validationRun.start_time|date: dateFormat :timeZone }}
      </span>

    </h5>
  </ng-template>
  <ng-template pTemplate="icons">
    <h5 class="my-0"><span class=" font-weight-normal">Name:</span> {{ model.validationRun.name_tag }}</h5>
  </ng-template>
  <div class="p-grid">
    <div class="p-col-4">
      <strong>Data:</strong><br/>
      <span *ngFor="let datasetRowModel of model.datasetRows">
          {{(datasetRowModel.dataset$|async)?.pretty_name}},
        {{(datasetRowModel.datasetVersion$|async)?.pretty_name}},
        {{(datasetRowModel.datasetVariable$|async)?.pretty_name}} <br>
        </span>

    </div>

    <div class="p-col-4">
      <strong>Reference:</strong><br/>
      <span>
          {{(model.referenceRow.dataset$|async)?.pretty_name}},
        {{(model.referenceRow.datasetVersion$|async)?.pretty_name}},
        {{(model.referenceRow.datasetVariable$|async)?.pretty_name}}
        </span>
    </div>

    <div class="p-col-2" style="max-width: 7rem;">
      <strong>Status:</strong><br/>
      {{ getStatusFromProgress(validationRun)}}
    </div>
  </div>
</p-panel>
